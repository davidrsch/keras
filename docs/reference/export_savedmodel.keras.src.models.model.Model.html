<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="(e.g. via TF-Serving).
Note: This can currently only be used with
the TensorFlow or JAX backends.
This method lets you export a model to a lightweight SavedModel artifact
that contains the model's forward pass only (its call() method)
and can be served via e.g. TF-Serving. The forward pass is registered
under the name serve() (see example below).
The original code of the model (including any custom layers you may
have used) is no longer necessary to reload the artifact -- it is
entirely standalone.
Note: This feature is currently supported only with TensorFlow, JAX
and Torch backends.
Note: Be aware that the exported artifact may contain information
from the local file system when using format=&quot;onnx&quot;, verbose=TRUE
and Torch backend."><title>Export the model as an artifact for inference. — export_savedmodel.keras.src.models.model.Model • keras3</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Export the model as an artifact for inference. — export_savedmodel.keras.src.models.model.Model"><meta property="og:description" content="(e.g. via TF-Serving).
Note: This can currently only be used with
the TensorFlow or JAX backends.
This method lets you export a model to a lightweight SavedModel artifact
that contains the model's forward pass only (its call() method)
and can be served via e.g. TF-Serving. The forward pass is registered
under the name serve() (see example below).
The original code of the model (including any custom layers you may
have used) is no longer necessary to reload the artifact -- it is
entirely standalone.
Note: This feature is currently supported only with TensorFlow, JAX
and Torch backends.
Note: Be aware that the exported artifact may contain information
from the local file system when using format=&quot;onnx&quot;, verbose=TRUE
and Torch backend."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KHBDBW7');</script><!-- End Google Tag Manager --></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    <!-- Google Tag Manager (noscript) --> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KHBDBW7" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript> <!-- End Google Tag Manager (noscript) -->


    <nav class="navbar fixed-top navbar-inverse navbar-expand-lg bg-primary" data-bs-theme="inverse"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">keras3</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.4.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/getting_started.html">Getting Started</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-guides">Guides</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-guides">
    <h6 class="dropdown-header" data-toc-skip>Model definition</h6>
    <a class="dropdown-item" href="../articles/sequential_model.html">Sequential Model</a>
    <a class="dropdown-item" href="../articles/functional_api.html">Functional API</a>
    <h6 class="dropdown-header" data-toc-skip>Extending and customizing</h6>
    <a class="dropdown-item" href="../articles/training_with_built_in_methods.html">Training &amp; evaluation with the built-in methods</a>
    <a class="dropdown-item" href="../articles/custom_train_step_in_tensorflow.html">Customizing `fit()` with Tensorflow</a>
    <a class="dropdown-item" href="../articles/writing_your_own_callbacks.html">Writing your own callbacks</a>
    <a class="dropdown-item" href="../articles/making_new_layers_and_models_via_subclassing.html">Making new layers and models via subclassing</a>
    <a class="dropdown-item" href="../articles/writing_a_custom_training_loop_in_tensorflow.html">Writing a training loop from scratch in TensorFlow</a>
    <a class="dropdown-item" href="../articles/serialization_and_saving.html">Serialization and Saving</a>
    <h6 class="dropdown-header" data-toc-skip>Other topics</h6>
    <a class="dropdown-item" href="../articles/transfer_learning.html">Transfer learning and fine tuning</a>
    <a class="dropdown-item" href="../articles/distributed_training_with_tensorflow.html">Distributed training with TensorFlow</a>
    <a class="dropdown-item" href="../articles/distribution.html">Distributed training with Jax</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/examples/index.html">Examples</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rstudio/keras3/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Export the model as an artifact for inference.</h1>
      <small class="dont-index">Source: <a href="https://github.com/rstudio/keras3/blob/HEAD/R/model-persistence.R" class="external-link"><code>R/model-persistence.R</code></a></small>
      <div class="d-none name"><code>export_savedmodel.keras.src.models.model.Model.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>(e.g. via TF-Serving).</p>
<p><strong>Note:</strong> This can currently only be used with
the TensorFlow or JAX backends.</p>
<p>This method lets you export a model to a lightweight SavedModel artifact
that contains the model's forward pass only (its <code><a href="https://rdrr.io/r/base/call.html" class="external-link">call()</a></code> method)
and can be served via e.g. TF-Serving. The forward pass is registered
under the name <code>serve()</code> (see example below).</p>
<p>The original code of the model (including any custom layers you may
have used) is <em>no longer</em> necessary to reload the artifact -- it is
entirely standalone.</p>
<p><strong>Note:</strong> This feature is currently supported only with TensorFlow, JAX
and Torch backends.</p>
<p><strong>Note:</strong> Be aware that the exported artifact may contain information
from the local file system when using <code>format="onnx"</code>, <code>verbose=TRUE</code>
and Torch backend.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for keras.src.models.model.Model</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tensorflow/man/export_savedmodel.html" class="external-link">export_savedmodel</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">export_dir_base</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"tf_saved_model"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  input_signature <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>A keras model.</p></dd>


<dt>export_dir_base</dt>
<dd><p>string, file path where to save
the artifact.</p></dd>


<dt>...</dt>
<dd><p>Additional keyword arguments:</p><ul><li><p>Specific to the JAX backend and <code>format="tf_saved_model"</code>:</p><ul><li><p><code>is_static</code>: Optional <code>bool</code>. Indicates whether <code>fn</code> is
static. Set to <code>FALSE</code> if <code>fn</code> involves state updates
(e.g., RNG seeds and counters).</p></li>
<li><p><code>jax2tf_kwargs</code>: Optional <code>dict</code>. Arguments for
<code>jax2tf.convert</code>. See the documentation for
<a href="https://github.com/jax-ml/jax/blob/main/jax/experimental/jax2tf/README.md" class="external-link"><code>jax2tf.convert</code></a>.
If <code>native_serialization</code> and <code>polymorphic_shapes</code> are
not provided, they will be automatically computed.</p></li>
</ul></li>
</ul></dd>


<dt>format</dt>
<dd><p>string. The export format. Supported values:
<code>"tf_saved_model"</code> and <code>"onnx"</code>.  Defaults to
<code>"tf_saved_model"</code>.</p></dd>


<dt>verbose</dt>
<dd><p>Bool. Whether to print all the variables of the exported model. Defaults
to <code>NULL</code>, which uses the default value set by different
backends and formats.</p></dd>


<dt>input_signature</dt>
<dd><p>Optional. Specifies the shape and dtype of the
model inputs. Can be a structure of <code>keras.InputSpec</code>,
<code>tf.TensorSpec</code>, <code>backend.KerasTensor</code>, or backend tensor. If
not provided, it will be automatically computed. Defaults to
<code>NULL</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>This is called primarily for the side effect of exporting <code>object</code>.
The first argument, <code>object</code> is also returned, invisibly, to enable usage
with the pipe.</p>
    </div>
    <div class="section level2">
    <h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a></h2>
    <p></p><div class="sourceCode r"><pre><code><span><span class="co"># Create the artifact</span></span>
<span><span class="va">model</span> <span class="op">|&gt;</span> <span class="fu">tensorflow</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tensorflow/man/export_savedmodel.html" class="external-link">export_savedmodel</a></span><span class="op">(</span><span class="st">"path/to/location"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Later, in a different process/environment...</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/tensorflow" class="external-link">tensorflow</a></span><span class="op">)</span></span>
<span><span class="va">reloaded_artifact</span> <span class="op">&lt;-</span> <span class="va">tf</span><span class="op">$</span><span class="va">saved_model</span><span class="op">$</span><span class="fu">load</span><span class="op">(</span><span class="st">"path/to/location"</span><span class="op">)</span></span>
<span><span class="va">predictions</span> <span class="op">&lt;-</span> <span class="va">reloaded_artifact</span><span class="op">$</span><span class="fu">serve</span><span class="op">(</span><span class="va">input_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># see tfdeploy::serve_savedmodel() for serving a model over a local web api.</span></span></code></pre><p></p></div>
<p>Here's how to export an ONNX for inference.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="co"># Export the model as a ONNX artifact</span></span>
<span><span class="va">model</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/tensorflow/man/export_savedmodel.html" class="external-link">export_savedmodel</a></span><span class="op">(</span><span class="st">"path/to/location"</span>, format <span class="op">=</span> <span class="st">"onnx"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the artifact in a different process/environment</span></span>
<span><span class="va">onnxruntime</span> <span class="op">&lt;-</span> <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/import.html" class="external-link">import</a></span><span class="op">(</span><span class="st">"onnxruntime"</span><span class="op">)</span></span>
<span><span class="va">ort_session</span> <span class="op">&lt;-</span> <span class="va">onnxruntime</span><span class="op">$</span><span class="fu">InferenceSession</span><span class="op">(</span><span class="st">"path/to/location"</span><span class="op">)</span></span>
<span><span class="va">input_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">....</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">input_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">ort_session</span><span class="op">$</span><span class="fu">get_inputs</span><span class="op">(</span><span class="op">)</span>, <span class="va">`[[`</span>, <span class="st">"name"</span><span class="op">)</span></span>
<span><span class="va">predictions</span> <span class="op">&lt;-</span> <span class="va">ort_session</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="cn">NULL</span>, <span class="va">input_data</span><span class="op">)</span></span></code></pre><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other saving and loading functions: <br><code><a href="layer_tfsm.html">layer_tfsm</a>()</code> <br><code><a href="load_model.html">load_model</a>()</code> <br><code><a href="load_model_weights.html">load_model_weights</a>()</code> <br><code><a href="register_keras_serializable.html">register_keras_serializable</a>()</code> <br><code><a href="save_model.html">save_model</a>()</code> <br><code><a href="save_model_config.html">save_model_config</a>()</code> <br><code><a href="save_model_weights.html">save_model_weights</a>()</code> <br><code><a href="with_custom_object_scope.html">with_custom_object_scope</a>()</code> <br></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tomasz Kalinowski, JJ Allaire, François Chollet, Posit Software, PBC, Google.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

